<template>
    <scroller>
        <div style="align-items: center;">
            <text style="font-size: 30px;color: black">{{location}}</text>
            <text style="font-size: 35px;color: lightsalmon;">{{watchlocation}}</text>
        </div>
    </scroller>
</template>

<script>
    module.exports = {
        data: {
            location: "等待定位数据",
            watchlocation: "watch location",
            i: 0
        },
        created: function () {
            var geolocation = require('@weex-module/geolocation');
            geolocation.getCurrentPosition(function (resultVo) {
                console.log("into--[getCurrentPosition success] resultVo:" + JSON.stringify(resultVo));
                this.location = JSON.stringify(resultVo);
            }.bind(this), function (resultVo) {
                console.log("into--[getCurrentPosition error] resultVo:" + JSON.stringify(resultVo));
                this.location = JSON.stringify(resultVo);
            }.bind(this), {enableHighAcuracy: false, address: true})

            geolocation.watchPosition(function (resultVo) {
                console.log("into--[watchPosition success] resultVo:" + JSON.stringify(resultVo));
                var str = this.watchlocation + '\n' + JSON.stringify(resultVo);
                this.watchlocation = str;
                this.i += 1;

                if (this.i == 2) {
                    geolocation.clearWatch(resultVo.registerId);
                    require('@weex-module/modal').toast({
                        'message': "[clear watch] id:"+resultVo.registerId,
                        'duration': 1
                    });
                }


            }.bind(this), function (resultVo) {
                console.log("into--[watchPosition success] resultVo:" + JSON.stringify(resultVo));
                this.watchlocation = JSON.stringify(resultVo);
            }.bind(this), {enableHighAcuracy: false, address: true})
        },
        methods: {}
    }
</script>